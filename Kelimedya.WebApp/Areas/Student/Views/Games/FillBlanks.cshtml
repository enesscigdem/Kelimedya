@{
    Layout = "~/Areas/Student/Views/Shared/_Layout.cshtml";
    ViewData["Title"] = "Boşluk Doldurma Oyunu";
}
<link href="~/css/FillBlanks.css" rel="stylesheet" />

<div class="container-xl" style="margin-top:1rem;">
  <div class="fullscreen-container">
    <div class="asmaca-header">
      Boşluk Doldurma Oyunu
    </div>
    <div class="fb-gamecard">
      <div class="fb-sentence" id="fbSentence">
        <!-- JS ile doldurulacak -->
      </div>

      <div class="fb-controls">
        <button id="fbCheck" class="simple-btn">Kontrol Et</button>
        <button id="fbReveal" class="simple-btn">Cevabı Göster</button>
        <button id="fbNext" class="simple-btn">Sonraki</button>
      </div>

      <div class="fb-feedback" id="fbFeedback"></div>
    </div>
  </div>
</div>

@section Scripts {
<script>
  const items = [
    { parts:["Düzenli çalışmak, sınavda "," olmanın anahtarıdır."], answers:["başarılı"] },
    { parts:["Sınav tarihine göre ders programını "," çok önemlidir."], answers:["planlamak"] },
    { parts:["Sınavda soruları "," okuyun."], answers:["dikkatlice"] }
  ];
  let idx=0;

  function renderCard(){
    // temizle
    const fb=document.getElementById("fbFeedback");
    fb.textContent=""; fb.className="fb-feedback";
    // eski input’ları sil
    document.querySelectorAll(".fb-input").forEach(i=>i.remove());

    // yeni cümle
    const card=items[idx], cont=document.getElementById("fbSentence");
    cont.innerHTML="";
    card.parts.forEach((txt,i)=>{
      cont.appendChild(document.createTextNode(txt));
      if(i<card.answers.length){
        const inp=document.createElement("input");
        inp.type="text"; inp.className="fb-input";
        inp.dataset.index=i; inp.placeholder="_____";
        cont.appendChild(inp);
      }
    });
  }

  function check(){
    let all=true;
    items[idx].answers.forEach((a,i)=>{
      const inp=document.querySelector(`.fb-input[data-index="${i}"]`);
      if(inp.value.trim().toLowerCase()===a){
        inp.classList.add("correct"); inp.classList.remove("wrong");
      } else {
        inp.classList.add("wrong"); inp.classList.remove("correct");
        all=false;
      }
    });
    const fb=document.getElementById("fbFeedback");
    fb.textContent=all?"🎉 Doğru!":"❌ Yanlış yerler.";
    fb.className=all?"fb-feedback correct":"fb-feedback incorrect";
  }

  function reveal(){
    items[idx].answers.forEach((a,i)=>{
      const inp=document.querySelector(`.fb-input[data-index="${i}"]`);
      inp.value=a; inp.classList.remove("wrong"); inp.classList.add("revealed");
    });
    const fb=document.getElementById("fbFeedback");
    fb.textContent="🔍 Cevap gösterildi."; fb.className="fb-feedback revealed";
  }

  document.getElementById("fbCheck").onclick=check;
  document.getElementById("fbReveal").onclick=reveal;
  document.getElementById("fbNext").onclick=()=>{
    idx=(idx+1)%items.length; renderCard();
  };
  document.addEventListener("DOMContentLoaded", renderCard);
</script>
}
