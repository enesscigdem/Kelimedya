@model Kelimedya.WebApp.Areas.Admin.Models.CreateUserViewModel

@{
    Layout = "~/Areas/Admin/Views/Shared/_Layout.cshtml";
    ViewData["Title"] = "Yeni Kullanıcı Ekle";
}

<div class="page-header d-print-none">
    <div class="container-xl">
        <div class="row g-2 align-items-center">
            <div class="col">
                <h2 class="page-title">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user-plus me-1"
                         width="28" height="28" viewBox="0 0 24 24" stroke-width="2"
                         stroke="currentColor" fill="none" stroke-linecap="round"
                         stroke-linejoin="round">
                        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                        <path d="M8 7a4 4 0 1 1 8 0a4 4 0 1 1 -8 0"/>
                        <path d="M16 19h6"/>
                        <path d="M19 16v6"/>
                        <path d="M6 21v-2a4 4 0 0 1 4 -4h4"/>
                    </svg>
                    Yeni Kullanıcı Ekle
                </h2>
                <div class="text-muted mt-1">
                    Sisteme manuel olarak kullanıcı ekleyin
                </div>
            </div>
        </div>
    </div>
</div>

<div class="page-body">
    <div class="container-xl">
        @if (!ViewData.ModelState.IsValid && ViewData.ModelState.Values.SelectMany(v => v.Errors).Any())
        {
            <div class="alert alert-danger" role="alert">
                @Html.ValidationSummary(false, "", new { @class = "mb-0" })
            </div>
        }
        <form asp-area="Admin" asp-controller="Users" asp-action="Create" method="post" class="card">
            <div class="card-header">
                <h3 class="card-title">Kullanıcı Bilgileri</h3>
            </div>
            <div class="card-body">
                <div class="mb-3">
                    <label class="form-label required">Ad</label>
                    <input type="text" asp-for="Name" class="form-control" placeholder="Örn: Ali" required/>
                    <span asp-validation-for="Name" class="text-danger"></span>
                </div>

                <div class="mb-3">
                    <label class="form-label required">Soyad</label>
                    <input type="text" asp-for="Surname" class="form-control" placeholder="Örn: Yılmaz" required/>
                    <span asp-validation-for="Surname" class="text-danger"></span>
                </div>

                <div class="mb-3">
                    <label class="form-label required">Telefon Numarası</label>
                    <input type="tel" asp-for="PhoneNumber" class="form-control" placeholder="05xxxxxxxxx" required/>
                    <span asp-validation-for="PhoneNumber" class="text-danger"></span>
                </div>

                <div class="mb-3">
                    <label class="form-label required">Sınıf</label>
                    <select asp-for="ClassGrade" class="form-select" required>
                        <option value="0">-- Sınıf Yok --</option>
                        @for (int i = 1; i <= 12; i++)
                        {
                            <!option value="@i" @(Model.ClassGrade == i ? "selected" : "")>@i. Sınıf</!option>
                        }
                    </select>
                    <span asp-validation-for="ClassGrade" class="text-danger"></span>
                </div>

                <div class="mb-3">
                    <label class="form-label required">Kullanıcı Adı</label>
                    <input type="text" asp-for="UserName" class="form-control" placeholder="Örn: aliyilmaz" required/>
                    <span asp-validation-for="UserName" class="text-danger"></span>
                </div>

                <div class="mb-3">
                    <label class="form-label required">E-posta</label>
                    <input type="email" asp-for="Email" class="form-control" placeholder="Örn: ali@example.com" required/>
                    <span asp-validation-for="Email" class="text-danger"></span>
                </div>

                <div class="mb-3">
                    <label class="form-label required">Şifre</label>
                    <input type="password" asp-for="Password" class="form-control" placeholder="******" required/>
                    <span asp-validation-for="Password" class="text-danger"></span>
                </div>

                <div class="mb-3">
                    <label class="form-label required">Rol</label>
                    <select asp-for="Role" class="form-select" id="roleSelect">
                        <option value="Admin">Admin</option>
                        <option value="Teacher">Öğretmen</option>
                        <option value="Student">Öğrenci</option>
                    </select>
                    <span asp-validation-for="Role" class="text-danger"></span>
                </div>
                <div class="mb-3" id="teacherSelectGroup" style="display:none;">
                    <label asp-for="TeacherId" class="form-label">Mentor Öğretmen</label>
                    <select asp-for="TeacherId" class="form-select">
                        <option value="">-- Seçiniz --</option>
                        @foreach (var t in Model.Teachers)
                        {
                            <!option value="@t.Value" @(t.Selected ? "selected" : "")>@t.Text</!option>
                        }
                    </select>
                </div>
            </div>

            <div class="card-footer text-end">
                <a asp-area="Admin" asp-controller="Users" asp-action="Index" class="btn btn-secondary">
                    Vazgeç
                </a>
                <button type="submit" class="btn btn-primary ms-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-check"
                         width="24" height="24" viewBox="0 0 24 24" stroke-width="2"
                         stroke="currentColor" fill="none" stroke-linecap="round"
                         stroke-linejoin="round">
                        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                        <path d="M5 12l5 5l10 -10"/>
                    </svg>
                    Kaydet
                </button>
            </div>
        </form>
    </div>
</div>
<script>
  document.getElementById('roleSelect').addEventListener('change', function(){
    document.getElementById('teacherSelectGroup').style.display =
      this.value === 'Student' ? 'block' : 'none';
  });
  if (document.getElementById('roleSelect').value === 'Student')
    document.getElementById('teacherSelectGroup').style.display = 'block';
</script>