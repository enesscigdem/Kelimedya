@{
    Layout = "~/Areas/Student/Views/Shared/_Layout.cshtml";
    ViewData["Title"] = "Görselden Soru Oyunu";
}
<link href="~/css/VisualPrompt.css" rel="stylesheet" />

<div class="container-xl" style="margin-top:1rem;">
  <div class="fullscreen-container">
    <header class="vp-header">
      <div class="kelime-header">Görselden Soru</div>
      <p>Bu görsel size hangi kelimeyi çağrıştırıyor?</p>
    </header>

    <div class="vp-gamecard">
      <div class="vp-image-area">
        <img id="vpImage" src="" alt="Soru Görseli" />
      </div>

      <div class="vp-controls">
        <input type="text" id="vpGuess" placeholder="Tahmininizi yazın..." />
        <button id="vpSubmit" class="vp-btn">Tahmin Et</button>
        <button id="vpReveal" class="vp-btn secondary">Cevabı Göster</button>
      </div>

      <div class="vp-feedback" id="vpFeedback"></div>

      <div class="vp-footer">
        <button onclick="location.href='@Url.Action("Index","Games", new { area = "Student" })'"
                class="vp-btn secondary">Geri Dön</button>
        <button id="vpNext" class="vp-btn">Sonraki</button>
      </div>
    </div>
  </div>
</div>

@section Scripts {
  <script>
    const images = [
      { src: "https://images.unsplash.com/photo-1593642634367-d91a135587b5?ixlib=rb-1.2.1...", answer: "dikkat etmek" },
      { src: "https://images.unsplash.com/photo-1517487881594-2787fef5ebf7?ixlib=rb-1.2.1...", answer: "planlamak" },
      { src: "https://images.unsplash.com/photo-1503676260728-1c00da094a0b?ixlib=rb-1.2.1...", answer: "başarmak" }
    ];
    let idx = 0;

    const imgEl = document.getElementById("vpImage"),
          guessEl = document.getElementById("vpGuess"),
          feedbackEl = document.getElementById("vpFeedback"),
          submitBtn = document.getElementById("vpSubmit"),
          revealBtn = document.getElementById("vpReveal"),
          nextBtn = document.getElementById("vpNext");

    function loadCard() {
      const card = images[idx];
      imgEl.src = card.src;
      guessEl.value = "";
      feedbackEl.innerHTML = "";
      feedbackEl.className = "vp-feedback";
    }

    submitBtn.onclick = () => {
      const user = guessEl.value.trim().toLowerCase(),
            correct = images[idx].answer.toLowerCase();
      if (!user) return;
      if (user === correct) {
        feedbackEl.innerHTML = `<span class="icon">✔︎</span> Doğru!`;
        feedbackEl.classList.add("correct");
      } else {
        feedbackEl.innerHTML = `<span class="icon">✖︎</span> Yanlış, tekrar deneyin.`;
        feedbackEl.classList.add("incorrect");
      }
    };

    revealBtn.onclick = () => {
      feedbackEl.innerHTML = `<span class="icon">🔍</span> Cevap: ${images[idx].answer}`;
      feedbackEl.classList.add("revealed");
    };

    nextBtn.onclick = () => {
      idx = (idx + 1) % images.length;
      loadCard();
    };

    document.addEventListener("DOMContentLoaded", loadCard);
  </script>
}
